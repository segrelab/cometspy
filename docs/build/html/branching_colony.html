<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Growth of a branching colony &mdash; COMETSpy  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=5929fcd5"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Growth and propagation of bacterial colonies on flat surfaces" href="demographic_noise_two_strains.html" />
    <link rel="prev" title="Growth of a circular colony" href="circular_colony.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html">
            
              <img src="_static/cometspy_logo_white_bkgd.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Package Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#what-is-cometspy">What is COMETSpy?</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#how-to-use-this-documentation">How to use this Documentation:</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#cite-us">Cite Us:</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installation-of-comets">Installation of COMETS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="capabilities.html">COMETS Capabilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="capabilities.html#capabilities-in-space">Capabilities in space</a></li>
<li class="toctree-l2"><a class="reference internal" href="capabilities.html#biological-capabilities">Biological capabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="capabilities.html#computational-capabilities">Computational capabilities</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#preparing-a-model-for-comets">Preparing a model for <code class="docutils literal notranslate"><span class="pre">COMETS</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="getting_started.html#setting-comets-simulation-parameters">Setting <code class="docutils literal notranslate"><span class="pre">COMETS</span></code> simulation parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#preparing-a-comets-simulation-layout">Preparing a <code class="docutils literal notranslate"><span class="pre">COMETS</span></code> simulation layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#running-a-comets-simulation">Running a <code class="docutils literal notranslate"><span class="pre">COMETS</span></code> simulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#checking-simulation-output-and-possible-errors">Checking simulation output and possible errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="getting_started.html#accessing-the-results-of-the-simulation">Accessing the results of the simulation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="test_tube.html">Growth in a test tube</a><ul>
<li class="toctree-l2"><a class="reference internal" href="test_tube.html#loading-the-comets-python-toolbox">Loading the COMETS Python Toolbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_tube.html#creating-a-test-tube">Creating a test tube</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_tube.html#loading-a-model">Loading a model</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_tube.html#setting-the-simulation-parameters">Setting the simulation parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_tube.html#running-the-simulation">Running the simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="test_tube.html#analyzing-the-results">Analyzing the results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="competition_assay.html">Two-species competition assay</a><ul>
<li class="toctree-l2"><a class="reference internal" href="competition_assay.html#load-models-and-create-a-mutant">Load models and create a mutant</a></li>
<li class="toctree-l2"><a class="reference internal" href="competition_assay.html#create-layout-add-models-and-set-up-media-composition">Create layout, add models and set up media composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="competition_assay.html#set-up-simulation-parameters">Set up simulation parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="competition_assay.html#run-the-simulation">Run the simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="competition_assay.html#simulating-serial-transfers">Simulating serial transfers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="citrate.html">Citrate utilization in the Long Term Evolution Experiment.</a></li>
<li class="toctree-l1"><a class="reference internal" href="chemostat.html">Crossfeeding in a chemostat</a></li>
<li class="toctree-l1"><a class="reference internal" href="evolution.html">Simulating evolution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="evolution.html#load-the-model">Load the model</a></li>
<li class="toctree-l2"><a class="reference internal" href="evolution.html#set-up-the-layout">Set up the layout</a></li>
<li class="toctree-l2"><a class="reference internal" href="evolution.html#set-up-simulation-parameters">Set up simulation parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="evolution.html#run-the-simulation">Run the simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="evolution.html#visualize-the-results">Visualize the results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="circular_colony.html">Growth of a circular colony</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Growth of a branching colony</a></li>
<li class="toctree-l1"><a class="reference internal" href="demographic_noise_two_strains.html">Growth and propagation of bacterial colonies on flat surfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="petri_dish.html">Simulating growth on Petri dish</a></li>
<li class="toctree-l1"><a class="reference internal" href="soil.html">Soil-air interface</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">COMETSpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Growth of a branching colony</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/branching_colony.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="growth-of-a-branching-colony">
<h1>Growth of a branching colony<a class="headerlink" href="#growth-of-a-branching-colony" title="Link to this heading"></a></h1>
<p>This is the exact same as the circular colony protocol notebook, except that a few parameters in the COMETS model have been changed to cause the colony to branch.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cobra</span>
<span class="kn">import</span> <span class="nn">cobra.test</span> <span class="c1"># for the ijo1366 model</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;/home/jeremy/Dropbox/work_related/harcombe_lab/segre/cometspy&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">cometspy</span> <span class="k">as</span> <span class="nn">c</span>
</pre></div>
</div>
<p>First, let’s make a “toy” model, using functionality of cobrapy. It directly converts extracellular carbon to biomass.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">carbon</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Metabolite</span><span class="p">(</span><span class="s2">&quot;carbon&quot;</span><span class="p">,</span>
                           <span class="n">compartment</span> <span class="o">=</span> <span class="s2">&quot;e&quot;</span><span class="p">)</span>
<span class="n">carbon_exch</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="s2">&quot;Carbon_exch&quot;</span><span class="p">,</span>
                            <span class="n">lower_bound</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span>
                            <span class="n">upper_bound</span> <span class="o">=</span> <span class="mf">1000.</span><span class="p">)</span>
<span class="n">carbon_exch</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">({</span><span class="n">carbon</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.</span><span class="p">})</span>
<span class="n">Biomass</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Reaction</span><span class="p">(</span><span class="s2">&quot;Biomass&quot;</span><span class="p">,</span>
                        <span class="n">lower_bound</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span>
                        <span class="n">upper_bound</span> <span class="o">=</span> <span class="mf">1000.</span><span class="p">)</span>
<span class="n">Biomass</span><span class="o">.</span><span class="n">add_metabolites</span><span class="p">({</span><span class="n">carbon</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.</span><span class="p">})</span>
<span class="n">toy</span> <span class="o">=</span> <span class="n">cobra</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s2">&quot;toy&quot;</span><span class="p">)</span>
<span class="n">toy</span><span class="o">.</span><span class="n">add_reactions</span><span class="p">([</span><span class="n">carbon_exch</span><span class="p">,</span> <span class="n">Biomass</span><span class="p">])</span>
<span class="n">toy</span><span class="o">.</span><span class="n">objective</span> <span class="o">=</span> <span class="s2">&quot;Biomass&quot;</span>
<span class="n">toy</span><span class="o">.</span><span class="n">repair</span><span class="p">()</span>
</pre></div>
</div>
<p>We can test that the model runs by doing FBA in cobrapy. It should generate as much biomass as the lower bound on carbon_exch.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">toy</span><span class="o">.</span><span class="n">medium</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">toy</span><span class="o">.</span><span class="n">optimize</span><span class="p">()</span><span class="o">.</span><span class="n">objective_value</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;Carbon_exch&#39;: 1.0}
1.0
</pre></div>
</div>
<p>We will now convert this into a COMETS model, set its initial biomass, and set the first set of convection parameters. These are the parameters needed to obtain a branching colony with this toy model. Note that the timestep has to be set very low for this form of biomass spread.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">grid_size</span> <span class="o">=</span> <span class="mi">30</span>

<span class="n">toy_comets</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">model</span><span class="p">(</span><span class="n">toy</span><span class="p">)</span>
<span class="n">toy_comets</span><span class="o">.</span><span class="n">initial_pop</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">grid_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span><span class="nb">int</span><span class="p">(</span><span class="n">grid_size</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span><span class="mf">1.0</span><span class="p">]</span>
<span class="n">toy_comets</span><span class="o">.</span><span class="n">open_exchanges</span><span class="p">()</span>
<span class="n">toy_comets</span><span class="o">.</span><span class="n">add_convection_parameters</span><span class="p">(</span><span class="n">packedDensity</span> <span class="o">=</span> <span class="mf">1.2</span><span class="p">,</span>
                                    <span class="n">elasticModulus</span> <span class="o">=</span> <span class="mf">5.e-3</span><span class="p">,</span>
                                    <span class="n">frictionConstant</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
                                    <span class="n">convDiffConstant</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="n">toy_comets</span><span class="o">.</span><span class="n">add_noise_variance_parameter</span><span class="p">(</span><span class="mf">20.</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Note: for convection parameters to function,
params.all_params[&#39;biomassMotionStyle&#39;] = &#39;Convection 2D&#39;
must also be set
</pre></div>
</div>
<p>We make sure that the COMETS model does not consider the biomass reaction an exchange.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">toy_comets</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">toy_comets</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">REACTION_NAMES</span> <span class="o">==</span> <span class="s2">&quot;Biomass&quot;</span><span class="p">,</span><span class="s2">&quot;EXCH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">toy_comets</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">toy_comets</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">REACTION_NAMES</span> <span class="o">==</span> <span class="s2">&quot;Biomass&quot;</span><span class="p">,</span><span class="s2">&quot;EXCH_IND&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">toy_comets</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">toy_comets</span><span class="o">.</span><span class="n">reactions</span><span class="o">.</span><span class="n">REACTION_NAMES</span> <span class="o">==</span> <span class="s2">&quot;Biomass&quot;</span><span class="p">,</span> <span class="s2">&quot;LB&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>This simulation’s layout will be of a single, centered colony on a 100x100 grid. carbon will be spread homogenously.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ly</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">layout</span><span class="p">([</span><span class="n">toy_comets</span><span class="p">])</span>
<span class="n">ly</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="p">[</span><span class="n">grid_size</span><span class="p">,</span> <span class="n">grid_size</span><span class="p">]</span>
<span class="n">ly</span><span class="o">.</span><span class="n">set_specific_metabolite</span><span class="p">(</span><span class="s2">&quot;carbon&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
</pre></div>
</div>
<p>The main parameter we need to set is biomassmotionstyle, which must be set to “Convection 2D”.  Then, to capture the spatial information, we’ll also log biomass (instead of just total biomass). Finally, we’ll also adjust a handful of other parameters. These are stored in the dictionary all_params.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">params</span><span class="p">()</span>

<span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;biomassMotionStyle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Convection 2D&quot;</span>
<span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;writeBiomassLog&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;BiomassLogRate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;maxCycles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20000</span>
<span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;timeStep&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.00025</span>
<span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;spaceWidth&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;maxSpaceBiomass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;minSpaceBiomass&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.25e-10</span>
<span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;allowCellOverlap&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;growthDiffRate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;flowDiffRate&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">3e-9</span>
<span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;exchangestyle&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Monod Style&quot;</span>
<span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;defaultKm&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;defaultHill&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;defaultVmax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span>

</pre></div>
</div>
<p>Now we make a simulation object and run it.  This can take awhile.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">comets</span><span class="p">(</span><span class="n">ly</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="c1"># this should all be removable once the installer is made with dependencies in a predictable location</span>
<span class="n">sim</span><span class="o">.</span><span class="n">set_classpath</span><span class="p">(</span><span class="s2">&quot;concurrent&quot;</span><span class="p">,</span> <span class="s2">&quot;/opt/colt/lib/concurrent.jar&quot;</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">set_classpath</span><span class="p">(</span><span class="s2">&quot;colt&quot;</span><span class="p">,</span> <span class="s2">&quot;/opt/colt/lib/colt.jar&quot;</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">set_classpath</span><span class="p">(</span><span class="s2">&quot;lang3&quot;</span><span class="p">,</span> <span class="s2">&quot;/opt/commons-lang3-3.9/commons-lang3-3.9.jar&quot;</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">set_classpath</span><span class="p">(</span><span class="s2">&quot;jmatio&quot;</span><span class="p">,</span><span class="s2">&quot;/opt/jmatio/lib/jmatio.jar&quot;</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">set_classpath</span><span class="p">(</span><span class="s2">&quot;math3&quot;</span><span class="p">,</span><span class="s2">&quot;/opt/commons-math3-3.6.1/commons-math3-3.6.1.jar&quot;</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">set_classpath</span><span class="p">(</span><span class="s2">&quot;bin&quot;</span><span class="p">,</span><span class="s2">&quot;/home/jeremy/Dropbox/work_related/harcombe_lab/segre/jars/comets_2.10.0.jar&quot;</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">set_classpath</span><span class="p">(</span><span class="s2">&quot;gurobi&quot;</span><span class="p">,</span><span class="s2">&quot;/opt/gurobi900/linux64/lib/gurobi.jar&quot;</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">set_classpath</span><span class="p">(</span><span class="s2">&quot;jdistlib&quot;</span><span class="p">,</span> <span class="s2">&quot;/opt/jdistlib-0.4.5-bin.jar&quot;</span><span class="p">)</span>

<span class="n">sim</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># use the argument delete_files = False to keep all COMETS-generated files</span>

</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Warning: java class libraries cannot be found
These are the expected locations for dependencies:
Dependency 			 expected path
__________ 			 _____________
gurobi			/opt/gurobi900/linux64/gurobi.jar
junit			/Dropbox/work_related/harcombe_lab/segre/comets/bin/lib/junit/junit-4.12.jar
hamcrest			/Dropbox/work_related/harcombe_lab/segre/comets/bin/lib/junit/hamcrest-core-1.3.jar
jogl_all			/Dropbox/work_related/harcombe_lab/segre/comets/bin/lib/jogl/jogamp-all-platforms/jar/jogl-all.jar
gluegen_rt			/Dropbox/work_related/harcombe_lab/segre/comets/bin/lib/jogl/jogamp-all-platforms/jar/gluegen-rt.jar
gluegen			/Dropbox/work_related/harcombe_lab/segre/comets/bin/lib/jogl/jogamp-all-platforms/jar/gluegen.jar
gluegen_rt_natives			/Dropbox/work_related/harcombe_lab/segre/comets/bin/lib/jogl/jogamp-all-platforms/jar/gluegen-rt-natives-linux-amd64.jar
jogl_all_natives			/Dropbox/work_related/harcombe_lab/segre/comets/bin/lib/jogl/jogamp-all-platforms/jar/jogl-all-natives-linux-amd64.jar
jmatio			/Dropbox/work_related/harcombe_lab/segre/comets/bin/lib/JMatIO/lib/jamtio.jar
jmat			/Dropbox/work_related/harcombe_lab/segre/comets/bin/lib/JMatIO/JMatIO-041212/lib/jmatio.jar
concurrent			/Dropbox/work_related/harcombe_lab/segre/comets/bin/lib/colt/lib/concurrent.jar
colt			/Dropbox/work_related/harcombe_lab/segre/comets/bin/lib/colt/lib/colt.jar
lang3			/Dropbox/work_related/harcombe_lab/segre/comets/bin/lib/commons-lang3-3.7/commons-lang3-3.7.jar
math3			/Dropbox/work_related/harcombe_lab/segre/comets/bin/lib/commons-math3-3.6.1/commons-math3-3.6.1.jar
bin			/Dropbox/work_related/harcombe_lab/segre/comets/bin/bin/comets_evo.jar

  You have two options to fix this problem:
1.  set each class path correctly by doing:
    comets.set_classpath(libraryname, path)
    e.g.   comets.set_classpath(&#39;hamcrest&#39;, &#39;/home/chaco001/comets/junit/hamcrest-core-1.3.jar&#39;)

    note that versions dont always have to exactly match, but you&#39;re on your own if they don&#39;t

2.  fully define the classpath yourself by overwriting comets.JAVA_CLASSPATH
       look at the current comets.JAVA_CLASSPATH to see how this should look.

Running COMETS simulation ...
Done!
</pre></div>
</div>
<p>Now let’s plot the results. Note how we specify the axes, otherwise “cycle”, “x”, and “y” will be assumed to be state variables.</p>
<p>What we see is that both species survive, because the LCTStex_KO cross-feeds galactose from the galE_KO, which uses the glucose piece of lactose. The metabolites, as is typical in a chemostat, are in very low concentrations once equilibrium is reached.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">im</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">get_biomass_image</span><span class="p">(</span><span class="s1">&#39;toy&#39;</span><span class="p">,</span> <span class="mi">1500</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.colors</span><span class="o">,</span> <span class="nn">matplotlib.cm</span>
<span class="n">my_cmap</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s2">&quot;copper&quot;</span><span class="p">)</span>
<span class="n">my_cmap</span><span class="o">.</span><span class="n">set_bad</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(),</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">my_cmap</span><span class="p">)</span>

</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x7f966a6b3630&gt;
</pre></div>
</div>
<p><img alt="" src="_images/branching_colony_1.png" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">big_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">grid_size</span> <span class="o">*</span> <span class="mi">8</span><span class="p">,</span> <span class="n">grid_size</span> <span class="o">*</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">im_cycles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;BiomassLogRate&quot;</span><span class="p">],</span> <span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;maxCycles&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;BiomassLogRate&quot;</span><span class="p">],</span>
                      <span class="n">p</span><span class="o">.</span><span class="n">all_params</span><span class="p">[</span><span class="s2">&quot;BiomassLogRate&quot;</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">cycle</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">im_cycles</span><span class="p">):</span>
    <span class="n">big_image</span><span class="p">[(</span><span class="n">grid_size</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)):(</span><span class="n">grid_size</span> <span class="o">+</span> <span class="n">grid_size</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="mi">5</span><span class="p">)),(</span><span class="n">grid_size</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">5</span><span class="p">)):(</span><span class="n">grid_size</span> <span class="o">+</span> <span class="n">grid_size</span> <span class="o">*</span> <span class="p">(</span><span class="n">i</span> <span class="o">%</span> <span class="mi">5</span><span class="p">))]</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">get_biomass_image</span><span class="p">(</span><span class="s2">&quot;toy&quot;</span><span class="p">,</span> <span class="n">cycle</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">big_image</span><span class="p">,</span> <span class="n">norm</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LogNorm</span><span class="p">(),</span> <span class="n">cmap</span> <span class="o">=</span> <span class="n">my_cmap</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="" src="_images/branching_colony_2.png" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="circular_colony.html" class="btn btn-neutral float-left" title="Growth of a circular colony" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="demographic_noise_two_strains.html" class="btn btn-neutral float-right" title="Growth and propagation of bacterial colonies on flat surfaces" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, The Segre Lab at Boston University.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>